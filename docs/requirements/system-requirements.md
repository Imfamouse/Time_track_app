# Техническое задание на ИС «Учёт рабочего времени»

Версия: 1.1 (редакция)  
Ответственный за правки: редактор методолог ТЗ  
Дата: 07.10.2025

## 0. Содержание
1. [Введение](#1-введение)  
   1.1. [Назначение и цели системы](#11-назначение-и-цели-системы)  
   1.2. [Термины, определения и бизнес правила](#12-термины-определения-и-бизнес-правила)
2. [Данные системы](#2-данные-системы)  
   2.1. [Сущности и атрибуты](#21-сущности-и-атрибуты)  
   2.2. [Управление данными (CRUD и аудит)](#22-управление-данными-crud-и-аудит)
3. [Роли и полномочия](#3-роли-и-полномочия)  
   3.1. [Описание ролей](#31-описание-ролей)  
   3.2. [Матрица доступа и особенности назначения прав](#32-матрица-доступа-и-особенности-назначения-прав)
4. [Функциональные требования](#4-функциональные-требования)  
   4.1. [Роль «Сотрудник»](#41-роль-сотрудник)  
   4.2. [Роль «Руководитель»](#42-роль-руководитель)  
   4.3. [Роль «Топ менеджер»](#43-роль-топ-менеджер)  
   4.4. [Роль «Менеджер проекта»](#44-роль-менеджер-проекта)  
   4.5. [Роль «Администратор системы»](#45-роль-администратор-системы)  
   4.6. [Роль «Старший администратор системы»](#46-роль-старший-администратор-системы)  
   4.7. [Роль «Наблюдатель»](#47-роль-наблюдатель)
5. [Отчётность и аналитика](#5-отчётность-и-аналитика)  
   5.1. [Предопределённые отчёты и экспорт](#51-предопределённые-отчёты-и-экспорт)  
   5.2. [Доступность отчётов по умолчанию](#52-доступность-отчётов-по-умолчанию)
6. [Уведомления](#6-уведомления)  
   6.1. [Общие правила](#61-общие-правила)  
   6.2. [Адресные уведомления по ролям](#62-адресные-уведомления-по-ролям)
7. [Технические и нефункциональные требования](#7-технические-и-нефункциональные-требования)  
   7.1. [Архитектура и интеграции](#71-архитектура-и-интеграции)  
   7.2. [Нефункциональные требования (производительность, безопасность, UX, надёжность)](#72-нефункциональные-требования-производительность-безопасность-ux-надёжность)
[Приложение A. Нормализация терминов и орфографии (выдержка)](#приложение-a-нормализация-терминов-и-орфографии-выдержка)  
[Приложение B. Правила вычисления показателей](#приложение-b-правила-вычисления-показателей)

## 1. Введение

### 1.1. Назначение и цели системы
**Назначение.** Корпоративное веб приложение для планирования задач, учёта и контроля фактических трудозатрат сотрудников.

**Цели:**
- повышение прозрачности планирования и выполнения работ;
- автоматизация сбора и утверждения данных о трудозатратах;
- снижение административной нагрузки на руководителей и сотрудников;
- формирование отчётности по проектам, подразделениям и сотрудникам.

### 1.2. Термины, определения и бизнес правила
**Отчётный период сотрудника** — календарная неделя, за которую сотрудник вносит фактические трудозатраты и формирует отчёт на утверждение руководителю.

**Статусы отчёта:** «Черновик», «На утверждении», «Утверждён», «Отклонён».

**Статусы задачи:** «Запланирована», «В работе», «Завершена», «Заблокирована».

**Календарные периоды для статистической отчётности (раздел 5):**
- неделя: прошлая, текущая, произвольная (с датами начала/окончания и номером недели; первый день — понедельник);
- месяц: текущий, прошлый, произвольный месяц текущего года;
- квартал: текущий, прошлый, произвольный квартал текущего года;
- год: текущий, прошлый;
- произвольный период (дата начала — дата окончания).

**Ключевые бизнес правила:**
1. Сотрудник не может редактировать утверждённые отчёты.
2. Руководитель может перевести ранее утверждённый отчёт в статус «Отклонён» — после чего сотрудник получает доступ к редактированию и повторной отправке.
3. Если задача имеет статус «Завершена» и у исполнителя отсутствуют неутверждённые трудозатраты по этой задаче, задача не отображается в его списке.
4. Для задачи со статусом «Завершена» внесение новых фактических трудозатрат запрещено.
5. Руководитель не может утверждать отчёты за будущие периоды.
6. При смене исполнителя уведомления получают новый и предыдущий исполнители, а также руководитель.
7. В один момент времени у задачи может быть только один текущий исполнитель; система хранит полную историю трудозатрат всех исполнителей.

## 2. Данные системы

### 2.1. Сущности и атрибуты
**Пользователь:** ФИО; должность; учётная запись; статус (активен/неактивен); категория (ОПП/АДМ).

**Подразделение:** наименование; код; руководитель (ссылка на пользователя).

**Проект:**
- номер запроса (обязательный, вручную менеджером проекта);
- уникальный идентификатор (генерируется системой);
- название (≤150 символов; обязательный);
- описание (обязательный);
- заказчик (обязательный);
- продукт (обязательный);
- менеджер проекта (ссылка на пользователя);
- плановые даты начала/окончания (обязательные);
- фактические даты начала/окончания (авто);
- статус: «Запланирован», «Выполняется», «Завершён».

Присвоение статуса «Запланирован» выполняется при создании проекта автоматически и не изменяется в момент создания. Статус «Выполняется» устанавливается автоматически при появлении >0 суммарных утверждённых фактических трудозатрат задач проекта. Публикация проекта не меняет статуса («Запланирован»).

**Задача:**
- уникальный идентификатор (авто);
- проект (ссылка; авто);
- тип: «коммерческая»/«внутренняя» (авто — по продукту проекта);
- название;
- описание (опционально);
- приоритет: «низкий» | «средний» (по умолчанию) | «высокий» | «критический»;
- статус: «Запланирована» (по умолчанию при создании) | «В работе» | «Завершена» | «Заблокирована»;
- плановые трудозатраты (часы) ≥ 0 (импорт MS Project или ввод менеджером проекта);
- фактические трудозатраты (часы) ≥ 0; при участии нескольких исполнителей хранится разрез по каждому исполнителю;
- остаточные трудозатраты = плановые − фактические (могут быть <0, =0, >0);
- плановые даты начала/окончания (импорт/ввод);
- фактические даты начала/окончания (авто);
- текущий исполнитель (единственный; назначает руководитель ответственного подразделения);
- иерархические атрибуты: «суммарная задача», «родительская задача» (импорт/ввод).

### 2.2. Управление данными (CRUD и аудит)
Система предоставляет создание/чтение/обновление/удаление данных по всем сущностям с обязательным аудит логом действий пользователей (дата/время, пользователь, операция, объект, прежние/новые значения критичных полей).

## 3. Роли и полномочия

### 3.1. Описание ролей
Сотрудник — основной пользователь, работающий над задачами.

Руководитель — управляет подразделением; имеет подчинённых.

Заместитель руководителя — полностью дублирует роль «Руководитель» и получает отчёты/уведомления сотрудников при назначении на подразделение.

Топ менеджер — высшее руководство (например, Генеральный директор).

Менеджер проекта — управляет содержимым проектов и их задач.

Администратор системы — настраивает систему, пользователей, справочники; не имеет доступа к бизнес данным вне своих личных.

Старший администратор системы — максимальные права; может исполнять функционал всех бизнес ролей и вносить любые изменения.

Наблюдатель — только просмотр согласно политике доступа.

### 3.2. Матрица доступа и особенности назначения прав
- Сотрудник: задачи/отчёты только свои; редактирование черновиков и отклонённых отчётов.
- Руководитель: всё, что «Сотрудник», плюс просмотр задач/отчётов подчинённых, утверждение/отклонение, смена исполнителя в своём подразделении, изменение приоритетов задач своего подразделения, установка требования обязательного комментария.
- Заместитель руководителя: получает все права и уведомления как «Руководитель» для назначенного подразделения.
- Топ менеджер: доступ к агрегированным данным, дашбордам и экспортам по всей организации; не редактирует задачи/отчёты рядовых сотрудников, если не является их руководителем.
- Менеджер проекта: загрузка/публикация/закрытие проекта; управление задачами проекта (кроме фактических трудозатрат и приоритетов); установка/изменение родительских задач; назначение ответственного подразделения; управление плановыми трудозатратами и датами.
- Администратор системы: настройка пользователей/ролей/структуры подразделений/справочников; календарные периоды отчётности; без доступа к чужим бизнес данным.
- Старший администратор системы: весь функционал «Администратора системы» и всех бизнес ролей; право экстренного вмешательства (разблокировки, исправления данных, принудительная смена статусов отчётов с журналированием причин).
- Наблюдатель: только чтение в рамках политики доступа.

Особенность множественной принадлежности сотрудников: если сотрудник состоит в нескольких подразделениях, «Руководитель» видит его задачи/отчёты только при условии, что он руководит хотя бы одним из подразделений сотрудника. Требуется корректная модель прав на уровне ACL/политик.

## 4. Функциональные требования

### 4.1. Роль «Сотрудник»
- Просмотр списка назначенных задач и их атрибутов (проект, трудозатраты, статус и т. п.).
- Внесение фактических трудозатрат по дням: часы; комментарий (по умолчанию необязателен; может быть обязательным по требованию руководителя).
- Просмотр суммарных утверждённых часов по каждой задаче.
- Просмотр остаточных трудозатрат (плановые − утверждённые фактические).
- Просмотр «задолженности» — разницы между нормативными трудозатратами за период и утверждёнными трудозатратами (за истекшие и текущий периоды).
- Формирование «Отчёта о трудозатратах» по выбранным задачам.
- Отправка отчёта на утверждение руководителю.
- Получение уведомлений об утверждении/отклонении; при отклонении — корректировка и повторная отправка.

### 4.2. Роль «Руководитель»
- Весь функционал «Сотрудника».
- Просмотр всех задач, где его подразделение назначено ответственным; назначение исполнителя из своего подразделения.
- Изменение приоритетов задач ответственного подразделения.
- Просмотр задач и отчётов всех сотрудников своего подразделения.
- Утверждение/отклонение отчётов с обязательным комментарием при отклонении.
- Смена исполнителя по задаче в рамках своего подразделения (с сохранением истории фактических трудозатрат).
- Запрет на одновременное назначение нескольких исполнителей.
- Перевод задачи в статус «Завершена».
- Установка статуса «обязательно» для комментария при формировании отчёта сотрудником.

### 4.3. Роль «Топ менеджер»
- Просмотр агрегированной информации по всем проектам и подразделениям.
- Доступ к сводным табличным отчётам и дашбордам (числовые и графические представления).
- Фильтрация по сотрудникам/подразделениям в разрезе периодов (неделя, месяц, квартал, год). Для проектов — от более ранней из плановой/фактической даты начала до более поздней из плановой/фактической даты окончания.
- Экспорт любых отчётов в Excel и CSV.

### 4.4. Роль «Менеджер проекта»
**Жизненный цикл проекта:**
- Загрузка нового проекта (номер запроса, название, заказчик, продукт, плановые даты и пр.).
- Назначение/смена менеджера проекта.
- Публикация проекта (задачи становятся видимыми для назначения пользователям).
- Закрытие проекта (все задачи переводятся в «Завершена»).

**Управление задачами проекта:**
- Добавление/редактирование/удаление задач через веб интерфейс.
- Назначение/смена ответственного подразделения по задаче. Если текущий исполнитель не относится к новому подразделению, система снимает его как исполнителя, сохраняя его фактические трудозатраты; сотрудник вправе отправить их на утверждение своему руководителю.
- Управление плановыми трудозатратами и плановыми датами начала/окончания.
- Установка/изменение родительской задачи (иерархия подзадач).
- Фиксация «первоначальных плановых трудозатрат» всех задач проекта (для учёта исходного бюджета человеко-часов).
- Ограничения: менеджер проекта не изменяет фактические трудозатраты и приоритеты задач.

**Контроль учета времени:**
- Установка статуса «Заблокирована» — запрещает внесение новых фактических трудозатрат; на утверждённые трудозатраты не влияет.
- Снятие «Заблокирована»: если фактические = 0 → «Запланирована»; если > 0 → «В работе».

**Мониторинг и отчётность:**
- Просмотр задач, трудозатрат (плановые/фактические/остаточные) и статусов в разрезе своих проектов.
- Формирование и экспорт «Отчёта №4 — Трудозатраты по проекту».

### 4.5. Роль «Администратор системы»
- Управление пользователями (создание/редактирование/деактивация).
- Управление категориями пользователя (ОПП/АДМ).
- Управление структурой подразделений.
- Назначение ролей и полномочий.
- Настройка справочников (типы задач, приоритеты, статусы, продукты, заказчики).
- Управление календарными периодами для отчётности.
- Без доступа к чужим бизнес данным (задачи/трудозатраты), кроме своих личных.

### 4.6. Роль «Старший администратор системы»
- Неограниченные права на управление данными: проекты, задачи, трудозатраты, пользователи, подразделения, продукты, заказчики, логи.
- Просмотр и управление всеми объектами, включая аудит логи.
- Коррекция любых атрибутов задач/проектов в обход обычных бизнес правил (с обязательным журналированием причин).
- Выполнение функций «Администратора системы».
- Назначение/переопределение ролей и полномочий для любого пользователя.
- Выполнение функций «Сотрудника», «Руководителя», «Топ менеджера».
- Экстренное вмешательство: разблокировки, исправление ошибочных данных, восстановление, принудительная смена статусов отчётов.

### 4.7. Роль «Наблюдатель»
- Только чтение данных согласно настройкам доступа (например, по проектам/подразделениям/пользователям, если разрешено политикой доступа).

## 5. Отчётность и аналитика

### 5.1. Предопределённые отчёты и экспорт
**Общие правила:**
- Построение отчётов по фильтрам: проект, подразделение, сотрудник, период, статус задачи, трудозатраты (плановые/фактические/остаточные).
- Построение графических отчетов.
- Экспорт: Excel (XLSX), CSV, JPEG (снимки графиков/дашбордов).
- Отчётный период выбирается по п. 1.2 либо произвольно (даты начала/окончания).

**Перечень отчётов:**
1. Отчёт №1 — Трудозатраты сотрудника за период. Разрез: сотрудник × задача; поля: плановые/остаточные; сравнение с фактическими по дням или неделям периода.
2. Отчёт №2 — Трудозатраты подразделения за период. Разрез: сотрудник × задача; временная шкала — дни/недели периода.
3. Отчёт №3 — Трудозатраты организации за период. Разрез: сотрудник × задача; временная шкала — дни/недели.
4. Отчёт №4 — Трудозатраты по проекту. Разрез: задача (плановые/остаточные) × сотрудник (текущий исполнитель + исторические исполнители при наличии) × фактические по дням/неделям периода.
5. Отчёт №5 — Трудозатраты по продукту. Разрез: продукт; сравнение плановых и фактических по дням/неделям периода.
6. Отчёт №6 — Задолженности по внесению трудозатрат за календарный период. Разрез: сотрудник; нормативные трудозатраты периода VS фактические по дням/неделям.

Доступ по видам отчётов может быть предоставлен индивидуально (перечень сущностей/областей данных, к которым разрешён доступ при формировании отчёта).

### 5.2. Доступность отчётов по умолчанию
- Отчёт №1: Сотрудник — только по себе; Руководитель — по сотрудникам своего подразделения.
- Отчёт №2: Руководитель — по своему подразделению; возможна агрегация нижестоящих подразделений.
- Отчёт №3: Топ менеджер — по всей организации; фильтр по подразделению (с агрегацией) или по сотруднику.
- Отчёт №4: Менеджер проекта — только по своим проектам (с выбором проекта); Топ менеджер — по любым проектам.
- Отчёт №5: Топ менеджер — по любым продуктам.
- Отчёт №6: Сотрудник — только по себе; Руководитель — по своему подразделению (с агрегацией нижестоящих); Топ менеджер — по всей организации/подразделениям/сотрудникам.

## 6. Уведомления

### 6.1. Общие правила
- Пакетная отправка каждые 5 минут при наличии необработанных событий; одинаковые события группируются (например, все новые задачи за интервал — одним уведомлением).
- Отправка уведомлений на электронную почту сотрудника в организации.
- В интерфейсе пользователь может просмотреть уведомление (пометка «прочитано») и перейти на связанную страницу («перейти к данным»).

### 6.2. Адресные уведомления по ролям
**Сотрудник:**
- Назначение на роль исполнителя задачи (первичное/смена исполнителя) — список задач.
- Снятие с роли исполнителя — список задач.
- Утверждение/отклонение отчёта — сведения об отчёте (при отклонении — комментарий руководителя).
- Перевод связанных задач в «Заблокирована»/«Завершена» — список задач.

**Руководитель:**
- Появление новых задач, где его подразделение назначено ответственным — список задач.
- Получение отчёта сотрудника на утверждение — сведения об отчёте.
- Смена ответственного подразделения по задаче: руководитель «старого» подразделения получает уведомление (список задач); руководитель «нового» — уведомление по правилу о новых задачах.

**Менеджер проекта:**
- Успешный импорт проекта — название, количество задач.
- Успешная публикация проекта — название, количество задач.
- Перевод задач проекта в «Завершена» — список задач.

## 7. Технические и нефункциональные требования

### 7.1. Архитектура и интеграции
- Доступ: только из внутрикорпоративной сети и через VPN; без доступа с внешних IP.
- Архитектура: клиент серверное веб приложение.
- Фронтенд: веб интерфейс (современные браузеры, без мобильной адаптации).
- Бэкенд: серверная часть бизнес логики.
- База данных: PostgreSQL.
- Сервер ОС: Windows Server 2012 R2 (обновление к другой ОС не предусмотрено).

**Импорт задач из MS Project:**
- Канал: веб интерфейс; форматы файла: JSON или XML.
- Импортируемые поля задачи: название; плановые трудозатраты; название ответственного подразделения (из поля «Ресурс» в MS Project); плановые даты начала/окончания; флаги «суммарная задача» и «родительская задача».
- Прочие атрибуты задачи получают значения по умолчанию (см. §2.1) и могут быть изменены менеджером проекта после загрузки.
- Поддерживается ручное создание проектов/задач через веб страницы.
- (Опционально) Импорт задач из MS Excel.

### 7.2. Нефункциональные требования (производительность, безопасность, UX, надёжность)
- Производительность: время отклика ≤ 3 секунд для типовых операций при номинальной нагрузке.
- Безопасность: интегрированная аутентификация по логину в корпоративной сети (SSO подход); доступ в систему без повторного ввода пароля при наличии активной учётной записи.
- Удобство использования (Usability): интуитивный интерфейс; десктопный сценарий (без мобильной адаптации).
- Надёжность/Доступность: доступность не менее 99,5% за расчётный период; аудит лог критичных действий.

## Приложение A. Нормализация терминов и орфографии (выдержка)
- «веб интерфейс», «веб приложение» (строчные; дефис).
- «отчёт», «утверждён», «ОС» — последовательное использование буквы «ё».
- Единые кавычки для статусов и ролей: «…».
- «MS Project» (без дефиса), «CSV», «JSON», «XML».
- «человеко-часы» — через дефис.

## Приложение B. Правила вычисления показателей
- Остаточные трудозатраты задачи = Плановые − Фактические (неограничены знаком).
- Статус задачи при разблокировке: если ΣФакт = 0 → «Запланирована»; если ΣФакт > 0 → «В работе».
- Проект «Выполняется»: если Σ утверждённых фактических трудозатрат по всем задачам проекта > 0.
